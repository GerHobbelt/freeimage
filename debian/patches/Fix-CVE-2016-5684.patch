From: Debian Science Maintainers <debian-science-maintainers@lists.alioth.debian.org>
Date: Mon, 10 Oct 2016 08:22:44 +0100
Subject: CVE-2016-5684

---
 Source/FreeImage/PluginXPM.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

--- a/Source/FreeImage/PluginXPM.cpp
+++ b/Source/FreeImage/PluginXPM.cpp
@@ -186,6 +186,11 @@ Load(FreeImageIO *io, fi_handle handle,
 			throw "Improperly formed info string";
 		}
 
+		// check info string
+		if((width <= 0) || (height <= 0) || (colors <= 0) || (cpp <= 0)) {
+			throw "Improperly formed info string";
+		}
+
         if (colors > 256) {
 			dib = FreeImage_AllocateHeader(header_only, width, height, 24, FI_RGBA_RED_MASK, FI_RGBA_GREEN_MASK, FI_RGBA_BLUE_MASK);
 		} else {
