Some modificatoins to the makefiles to help in build Debian packages.
Also removed -s (strip) option so we can make debug package. With the compiler
options we're using by default, debugging should still be possible.
==========================================================================
Index: freeimage/Makefile.fip
===================================================================
--- freeimage.orig/Makefile.fip
+++ freeimage/Makefile.fip
@@ -4,18 +4,21 @@
 include fipMakefile.srcs
 
 # General configuration variables:
-CC = gcc
-CXX = g++
+CC ?= gcc
+CXX ?= g++
 AR = ar
 
-INCDIR = /usr/include
-INSTALLDIR = /usr/lib
+# Include a configurable DESTDIR variable
+DESTDIR ?= /
+INCDIR = $(DESTDIR)usr/include
+INSTALLDIR = $(DESTDIR)usr/lib
 
 # Converts cr/lf to just lf
 DOS2UNIX = dos2unix
 
-COMPILERFLAGS = -O3 -fexceptions -fvisibility=hidden
-LIBRARIES = -lstdc++
+COMPILERFLAGS ?= -O3 -fexceptions -fvisibility=hidden
+COMPILERFLAGS += $(shell getconf LFS_CFLAGS)
+LIBRARIES = -lmng -lz -lpng -lm -ljpeg -lopenjpeg $(shell pkg-config --libs OpenEXR)
 
 MODULES = $(SRCS:.c=.o)
 MODULES := $(MODULES:.cpp=.o)
@@ -56,7 +58,7 @@
 	$(AR) r $@ $(MODULES)
 
 $(SHAREDLIB): $(MODULES)
-	$(CC) -s -shared -Wl,-soname,$(VERLIBNAME) -o $@ $(MODULES) $(LIBRARIES)
+	$(CXX) -shared -Wl,-soname,$(VERLIBNAME) -Wl,-z,defs -o $@ $(MODULES) $(CXXFLAGS) $(LIBRARIES)
 
 install:
 	install -m 644 -o root -g root $(HEADER) $(INCDIR)
@@ -65,7 +67,6 @@
 	install -m 755 -o root -g root $(SHAREDLIB) $(INSTALLDIR)
 	ln -sf $(SHAREDLIB) $(INSTALLDIR)/$(VERLIBNAME)
 	ln -sf $(VERLIBNAME) $(INSTALLDIR)/$(LIBNAME)
-	ldconfig
 
 clean:
 	rm -f core Dist/*.* u2dtmp* $(MODULES) $(STATICLIB) $(SHAREDLIB) $(LIBNAME)
Index: freeimage/Makefile.gnu
===================================================================
--- freeimage.orig/Makefile.gnu
+++ freeimage/Makefile.gnu
@@ -4,18 +4,21 @@
 include Makefile.srcs
 
 # General configuration variables:
-CC = gcc
-CXX = g++
+CC ?= gcc
+CXX ?= g++
 AR = ar
 
-INCDIR = /usr/include
-INSTALLDIR = /usr/lib
+# Include a configurable DESTDIR variable
+DESTDIR ?= /
+INCDIR = $(DESTDIR)usr/include
+INSTALLDIR = $(DESTDIR)usr/lib
 
 # Converts cr/lf to just lf
 DOS2UNIX = dos2unix
 
-COMPILERFLAGS = -O3 -fPIC -fexceptions -fvisibility=hidden
-LIBRARIES = -lstdc++
+COMPILERFLAGS ?= -O3 -fPIC -fexceptions -fvisibility=hidden
+COMPILERFLAGS += $(shell getconf LFS_CFLAGS)
+LIBRARIES = -ljpeg -lmng -lopenjpeg -lpng $(shell pkg-config --libs OpenEXR) -lz -lm
 
 MODULES = $(SRCS:.c=.o)
 MODULES := $(MODULES:.cpp=.o)
@@ -55,7 +57,7 @@
 	$(AR) r $@ $(MODULES)
 
 $(SHAREDLIB): $(MODULES)
-	$(CC) -s -shared -Wl,-soname,$(VERLIBNAME) -o $@ $(MODULES) $(LIBRARIES)
+	$(CXX) -shared -Wl,-soname,$(VERLIBNAME) -Wl,-z,defs -o $@ $(MODULES) $(CXXFLAGS) $(LIBRARIES)
 
 install:
 	install -m 644 -o root -g root $(HEADER) $(INCDIR)
@@ -63,7 +65,6 @@
 	install -m 755 -o root -g root $(SHAREDLIB) $(INSTALLDIR)
 	ln -sf $(SHAREDLIB) $(INSTALLDIR)/$(VERLIBNAME)
 	ln -sf $(VERLIBNAME) $(INSTALLDIR)/$(LIBNAME)	
-	ldconfig
 
 clean:
 	rm -f core Dist/*.* u2dtmp* $(MODULES) $(STATICLIB) $(SHAREDLIB) $(LIBNAME)
